<!DOCTYPE html>
<html>
<head>
    <title>Test NFT Category</title>
</head>
<body>
    <h1>Test de cat√©gorie NFT</h1>
    <p>Ouvrez la console pour voir les tests</p>

    <script>
        // Simuler la fonction saveSubmittedNFT
        const NFT_STORAGE_KEY = 'nft_marketplace_submitted_nfts';

        const getSubmittedNFTs = () => {
            try {
                const stored = localStorage.getItem(NFT_STORAGE_KEY);
                return stored ? JSON.parse(stored) : [];
            } catch (error) {
                console.error('Erreur r√©cup√©ration NFTs:', error);
                return [];
            }
        };

        const saveSubmittedNFT = (nftData) => {
            try {
                const existingNFTs = getSubmittedNFTs();
                const newNFT = {
                    ...nftData,
                    id: Date.now(),
                    submittedAt: new Date().toISOString(),
                    status: 'submitted'
                };

                const updatedNFTs = [...existingNFTs, newNFT];
                localStorage.setItem(NFT_STORAGE_KEY, JSON.stringify(updatedNFTs));

                return newNFT;
            } catch (error) {
                console.error('Erreur sauvegarde NFT:', error);
                return null;
            }
        };

        // Test des cat√©gories
        function testCategories() {
            console.log('üß™ Test de sauvegarde de cat√©gories');

            const categories = ['Digital Art', 'Gaming', 'Abstract', 'Nature', 'Retro', 'Photography', '3D Art'];

            // Nettoyer d'abord
            localStorage.removeItem(NFT_STORAGE_KEY);

            categories.forEach((category, index) => {
                console.log(`\n${index + 1}Ô∏è‚É£ Test cat√©gorie: "${category}"`);

                const nftData = {
                    name: `Test NFT ${index + 1}`,
                    description: `Description du NFT de test ${index + 1}`,
                    category: category,
                    price: 0,
                    forSale: false,
                    image: 'data:image/png;base64,test',
                    likes: 0,
                    views: 0,
                    owner: 'Vous',
                    seller: null,
                    tokenId: null,
                    contractAddress: null,
                    blockchainStatus: 'local-only'
                };

                console.log('üìù Donn√©es avant sauvegarde:');
                console.log(`   - Nom: ${nftData.name}`);
                console.log(`   - Cat√©gorie: "${nftData.category}"`);

                const savedNFT = saveSubmittedNFT(nftData);

                console.log('üíæ Donn√©es apr√®s sauvegarde:');
                console.log(`   - Nom: ${savedNFT.name}`);
                console.log(`   - Cat√©gorie: "${savedNFT.category}"`);

                if (savedNFT.category === nftData.category) {
                    console.log('‚úÖ Cat√©gorie conserv√©e correctement');
                } else {
                    console.error('‚ùå PROBL√àME: Cat√©gorie chang√©e!');
                    console.error(`   Attendu: "${nftData.category}"`);
                    console.error(`   Obtenu: "${savedNFT.category}"`);
                }
            });

            // V√©rifier le contenu final
            console.log('\nüìã Contenu final du localStorage:');
            const stored = localStorage.getItem(NFT_STORAGE_KEY);
            if (stored) {
                const nfts = JSON.parse(stored);
                nfts.forEach((nft, index) => {
                    console.log(`   ${index + 1}. "${nft.name}" - Cat√©gorie: "${nft.category}"`);
                });
            } else {
                console.log('   Aucune donn√©e trouv√©e');
            }

            return JSON.parse(stored);
        }

        // Ex√©cuter le test automatiquement
        console.log('üöÄ D√©marrage des tests...');
        const results = testCategories();
        console.log('\n‚úÖ Tests termin√©s. R√©sultats stock√©s dans window.testResults');
        window.testResults = results;
    </script>
</body>
</html>